# like-back CiC テスト詳細ログ (2026-02-17)

## テスト概要
- アカウント: @SundererD27468
- 対象ツイート: いいね1件以上の最新5件
- いいねくれた人: 15ユニークユーザー
- いいね返し実行: 10ユーザー x 2件 = 20件（日次上限到達）
- 残り5ユーザーは翌日に持ち越し

## 躓きポイント詳細

### 1. CiCでのいいねユーザー収集が極端に遅い
**状況**: 最初にCiCでツイート詳細→いいね数クリック→ユーザー一覧取得を試みた
**問題**:
- いいね数の「数字部分」をクリックすると `/likes` ページに飛ぶはずが、ハートアイコンをクリックしてしまい自分のいいねが付いてしまった（4→5件に増加）
- `/likes` ページのURLを直接叩く方法に切り替えたが、1ツイートずつナビゲーションが必要で遅い
- CiCで4ユーザー取得に約10分

**解決策**: X API `GET /2/tweets/:id/liking_users` ($0.005/回) でPythonスクリプトから一括取得。4ツイート分12ユーザーを5秒で取得完了。

**教訓**: データ収集フェーズはAPIに任せ、CiCはアクション実行（いいねクリック）のみに使う。

### 2. `find` クエリの不安定さ
**状況**: いいねボタンのref IDを取得するための`find`クエリ
**問題**:
- `find("like button heart")` → 動く時と「マッチなし」の時がある
- 同じページでもタイミングによって結果が変わる
- エラー時は「"いいね" ボタンはあるが "heart" ラベルではない」と返ってくる

**安定クエリ**: `find("いいねする button")` が最も安定。全テストで100%成功。

**findの戻り値パターン**:
```
- ref_162: button ""0 件のいいね。いいねする""  ← 未いいね
- ref_179: button ""113 件のいいね。いいねしました""  ← いいね済み
```

**教訓**: 日本語で「いいねする button」を使う。英語の "like button heart" は不安定。

### 3. ref IDのシフト問題
**状況**: @TakanoriAzegamiのプロフィールで、findでref_179(10いいねのツイート)を取得→スクロール→クリック
**問題**: スクロールした後にクリックしたら、期待と違うツイートのいいねボタンが反応した
- 期待: codexツイート(10L)のハート
- 実際: 「何かの暗号か？」ツイート(11L)のハート

**原因推定**: スクロールによりDOM要素が再描画され、ref IDの参照先が変わった可能性

**教訓**: `find` と `click` の間にスクロールを挟まない。findした直後にクリックする。

### 4. いいね済み検出の方法
**状況**: @yoppy0123のプロフィールで、一部のツイートに既にいいね済み（赤ハート）
**問題**: スクショを見て目視で赤ハートを判定していた（遅い）

**解決策**: `find("いいねする button")` の戻り値テキストで自動判定可能:
- `"いいねする"` → 未いいね → クリック対象
- `"いいねしました"` → いいね済み → スキップ

**教訓**: findの戻り値をパースして自動判定すれば、スクショ検証不要。

### 5. リポスト中心アカウントの扱い
**状況**: @hattatsu0930 のタイムラインがほぼリポスト（フルエレ、びねつ、ぬこぬこ等）
**問題**: オリジナルツイートが見つからず、リポストにいいねしていいのか判断に迷った

**結果**: リポストにいいねした → **NG判明**。いいね通知がリポスト元（フルエレ、びねつ）に届き、hattatsu本人には届かない。いいね返しの目的（相手とのエンゲージメント構築）が達成できない。
**教訓**: リポストへのいいねは禁止。オリジナルツイートが見つかるまでスクロールし、なければそのユーザーはスキップする。

### 6. スクショ検証のオーバーヘッド
**状況**: 各ユーザーでいいね後にスクショ撮影→Read→確認
**問題**: 1ユーザーあたり+1-2分のオーバーヘッド。10ユーザーで10-20分のロス。

**教訓**: いいねクリックの成否はfindの再実行（「いいねしました」への変化）で確認可能。スクショは最初と最後だけで十分。

### 7. 座標クリック vs ref クリック
**状況**: 最初@TakanoriAzegamiでハートの座標を直接クリックしようとした
**問題**: 座標がずれてツイート本文をクリック→詳細ページに遷移してしまった

**解決策**: `find` → ref IDでクリック。座標推測は一切不要。
**教訓**: CiCでのクリックは常にfind→refパターンを使う。座標クリックは禁止。

## パフォーマンス実測

### データ収集フェーズ
| 方法 | 所要時間 | コスト |
|------|---------|-------|
| CiC (1ツイートずつ /likes ナビ) | ~10分/4ユーザー | $0.00 |
| API (liking_users一括) | ~5秒/4ツイート12ユーザー | $0.02 |

### いいね実行フェーズ（CiC）
| ステップ | 所要時間 |
|---------|---------|
| ナビゲーション | 2-3秒 |
| スクロール（1-2回） | 2-3秒 |
| find実行 | 1-2秒 |
| クリック x 2 | 1-2秒 |
| スクショ検証（省略可能） | 5-10秒 |
| **1ユーザー合計** | **10-20秒（検証なし）/ 20-30秒（検証あり）** |

### 全体
- 10ユーザー（検証あり）: 約30-40分
- 10ユーザー（検証なし・最適化後目標）: 約5-10分

## CiC操作の安定パターン（確立済み）

```
1. navigate("https://x.com/{username}")
2. scroll(down, 3-5)  # プロフィール情報を飛ばす
3. find("いいねする button")
4. 戻り値から「いいねする」（未いいね）のref IDを2つ選択
5. click(ref_xxx)
6. click(ref_yyy)
7. 次のユーザーへ
```

## 処理済みユーザー一覧

| # | ユーザー | フォロワー | 特徴 | いいね対象 |
|---|---------|-----------|------|----------|
| 1 | @TakanoriAzegami | 1,825 | エンジニア、リピーター(3回) | オリジナルツイート2件 |
| 2 | @nyax_nx | 152 | ねこ、RT多め | 気圧ツイート + 固定ツイート |
| 3 | @tofu_D_kozo | 786 | 個人開発者 | Googleサイトエクスポート + Firebase引用RT |
| 4 | @seckey_101296 | 630 | AIコンサルタント | AI時代記事 + 他人への期待引用RT |
| 5 | @orion_ai_m | 33 | フォロー中 | gogcli + treeコマンド |
| 6 | @hattatsu0930 | 288 | リポスト中心 | フルエレRT + びねつRT |
| 7 | @popo_fukugyo | 866 | AI副業 | 出社ツイート + AI回答方法 |
| 8 | @yoppy0123 | 1,467 | VPoE、Claude Code系 | 生成AI組織活用 + Cloudflare記事 |
| 9 | @Lovanaut | 24 | 個人開発(lovai.app) | AIの使い方 + 文脈SNS |
| 10 | @koretsuta_post | 14 | これつたサービス | Antigravityコツ + 見守りツイート |

## 翌日持ち越しユーザー
@A_Genno, @y_____pi06, @build_up_daily, @a_t_mosphere, @rhain428812
（全員「失業予想」ツイート(2/14)のいいねユーザー）
