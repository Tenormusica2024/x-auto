# ユーザー修正ログ参照手順（user_corrections_log）

## 概要

`history/user_corrections_log.json` を読み込み、ユーザーが過去に行ったツイート修正の傾向を把握する。
rejection_log（AI判定の落選記録）とは異なり、こちらは**人間の判断による修正指摘**を蓄積したもの。

## 二軸フィードバックの位置づけ

| 軸 | ソース | ファイル | 性質 |
|----|--------|---------|------|
| 軸1: スキル直接修正 | ユーザー指摘 → スキルファイル編集 | 各skills/*.md | 即効性（次回生成から反映） |
| 軸2: 修正ログ蓄積 | ユーザー指摘 → 自動記録 | user_corrections_log.json | 傾向分析（パターン検出） |

両軸を併用することで、個別修正の即効性と、蓄積データによる傾向把握の両方を得る。

## 読み込み先

`C:\Users\Tenormusica\x-auto\history\user_corrections_log.json`

## 記録タイミング（MANDATORY）

ユーザーがツイート生成セッション中に以下のいずれかを行った場合、**スキルファイルへの反映と同時に**このログにも記録する:

- ツイート文の修正指示（表現・語尾・構成・トーン等）
- A判定ツイートの採用拒否 + 理由説明
- 生成ルール・判定基準への改善要求
- 「こういう表現はやめて」「こっちの方がいい」等の品質フィードバック

## 記録フォーマット

```json
{
  "date": "2026-02-21",
  "type": "expression | structure | tone | topic | rule_change | other",
  "summary": "修正内容の要約（30字以内）",
  "before": "修正前の表現や状態（あれば）",
  "after": "修正後の表現や状態（あれば）",
  "correction": "ユーザーの指摘内容",
  "applied_to": "修正を反映したファイル名（例: expression-rules.md）"
}
```

### typeの定義

| type | 対象 | 例 |
|------|------|-----|
| `expression` | 語尾・言い回し・文体 | 「敬語調の語尾を避ける」「翻訳感のある表現をやめる」 |
| `structure` | 文章構成・段落構造 | 「結論を先にしてほしい」「箇条書きが多すぎる」 |
| `tone` | トーン・温度感 | 「もっと断定的に」「煽りすぎ」 |
| `topic` | ネタ選定・テーマ | 「このテーマは避けて」「もっと実践的な話を」 |
| `rule_change` | ルール・判定基準の変更 | 「この判定基準を緩めて」「新しいルールを追加」 |
| `other` | 上記に該当しない | その他の修正指摘 |

## 活用方法

1. `corrections` 配列の直近20件を確認
2. `type` の頻出項目を特定（例: `expression` が5回 → 表現品質に課題あり）
3. 同じ `type` での `correction` を集約し、ユーザーの好みの傾向を把握
4. 生成時に頻出修正パターンを事前回避

## GC（ガベージコレクション）

`corrections` が50件を超えたら古い方から削除（直近50件のみ保持）。
rejection_log（30件）より多く保持するのは、人間フィードバックの方が情報価値が高いため。

## 注意

- user_corrections_log.json が存在しない/空の場合はスキップ
- 生成前の「データインプット」フェーズで rejection_log の直後に読み込む
- ユーザーが口頭で指摘した内容も記録対象（明文化されていないフィードバックこそ価値が高い）
